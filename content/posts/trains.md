---
title: "How I took trains (not planes) and reached the Pyrenees 💡"
subtitle: ""
date: 2024-08-14T17:04:23+02:00
lastmod: 2024-08-14T17:04:23+02:00
authors: []
description: ""

tags: []
categories: []
series: []

hiddenFromHomePage: false
hiddenFromSearch: false

featuredImage: ""
featuredImagePreview: ""

toc:
  enable: true
math:
  enable: false
lightgallery: true
license: ""
---

<!--more-->

## intro 🚂

I was invited to join some friends on a mountain bike tour in the Pyrenees. I was ready, as was my bike. The only thing left to solve was how to get there.

TODO: insert a picture of my bike on a globe, and a lightbulb idea to take regional trains. maybe a google map screenshot.

This is the story of how I took regional times and went through 5 international boarders along the way. (Austria, Italy, Monaco, France 🇦🇹->🇮🇹->🇫🇷->🇲🇨->🇫🇷).

I hope it helps anyone who is thinking about taking a similar journey.

## The route 🗺️

TODO: insert a maplibre-gl map with the route from the journey data.

## Planning 📅

So first things first, you need to plan your route and know which way you are going.

I must confess I sinned and used the mighty google maps to help planning and decide which route to take. It actually has great coverage across europe and everyone knows that google maps kills it in terms of a easy and quick user experience.

{{< image src="/media/trains/google_maps.png" alt="Screenshot of Google Maps" >}}

Bear in mind that your mileage may vary, depending on where you want to travel in the world and there are other tools out there.

{{<admonition type="tip" title="Tip" open="true">}}
I hear very good things from my friends about [www.trainline.eu](www.trainline.eu).

There is also a couple projects out there which are handy when planning such a route as mine. [https://www.bahn.guru/](https://www.bahn.guru/) is a great tool for planning train routes in Europe. It is a open source project and has a great community behind it. I also used [https://www.chronotrains.com/en](https://www.chronotrains.com/en) to check the train times and prices.
{{</admonition>}}

I needed to travel from Innsbruck in Austria to la tour de carol in France, which meant I would need to traverse around the alps and then south to the pyraness. I entered the start and end points into google maps and it gave me a few options including routes via Zurich, Paris and Milan.

I considered the different options and decided to take regional trains for this journey through italy and the french coast. It would of actually been quicker to take the high speed train via zurich and paris, but not significantly. Plus I had the privilege of free time on hand and the luxury of deciding where I wanted to be with having to be at a specific place at a specific time. This meant that I could split up the journey and enjoy some of the beautiful places along the way. Booyah!

Taking the regional trains was a easy choice, as although slower, they have more space for bikes. I had some beautiful views of the Alps, the Italtian Rivera and Côte d'Azur. It also meant I went through Monaco, and could weave between the super expensive sports cars of the rich people stuck in traffic on my bike, living the best life.

## Bike reservation 🚳

The big question: Can you take your bike on the train and do you need to reserve a spot for your bike? The answer is, it depends.

Most european trains have spaces for bikes. A reservation is usually mandatory for high speed trains. In the summer months, there reservations are often sold out, so it is best to book in advance.

Some high speed trains do allow fully assembled bikes, but this and not having a reservation can be worked around with a rinko bike bag set-up.

Regional trains are the best for bike travel, almost always have space for bikes and you don't need a reservation.

There are some good resources out there which list the reservation conditions for each train company. 

- [https://help.raileurope.com/article/41750-taking-bikes-on-the-train](https://help.raileurope.com/article/41750-taking-bikes-on-the-train)

Otherwise, each of the train providers has a webpage with all the infomation you need.

- [🇩🇪 Deutsche Bahn](https://www.bahn.de/angebot/zusatzticket/checkliste-fahrradmitnahme)
- [🇦🇹 Öbb](https://www.oebb.at/en/reiseplanung-services/im-zug/fahrradmitnahme)
- [🇫🇷 SNCF](https://www.sncf-voyageurs.com/en/travel-with-us/train-and-bike/bike-on-board/)
- [🇮🇹 Trenitalia](https://www.trenitalia.com/en/services/travelling_with_yourbike.html)
- [🇪🇸 Renfe](https://www.renfe.com/es/en/travel/informacion-util/luggage/bicycles-and-kick-scooters-_non-electric_)
- [🇳🇱 NS](https://www.ns.nl/en/travel-information/bikes-on-the-train.html)

{{<admonition type="tip" title="Tip" open="true">}}

When using a train carrier website, you can usually find the filter the connections to only show those that allow bikes. This makes planning with a bike easy peazy lemon squeezey 🍋.

{{</admonition>}}

### My reservation learnings 🚲

Everyones trip will be different depending on the region they are travelling, but here is what I experienced on my journey.

#### Öbb 🇦🇹

The first trip I took involved a s-bahn from Innsbruck up to the Brenner pass. This is a historical place known for. And the train winds through the valley offering beautiful views all the way.

You don't have to make any reservation, but need to buy a bike ticket for TODO:. There is ample space on the modern trains to carry bikes.

TODO: insert picture of the sbahn.

#### Trenitalia 🇮🇹

There are multiple train operators in Italy. Trenitalia is the national company, but there is also Trenord, TODO: add the others. Possibilities to take the bike on board vary depending on which company owns the train.

I took the regional trains through the northen part of the country.

Between Brenner and Verona, I 

Then I needed to go via Milano, to Genova and then through Liguria along the Italian Rivera to the french Boarder.

A bike ticket costs a extra 3.50.

It's possible to take a french train from Ventimiglia, the last town in Italy to Nice in France, and you can take your bike with you. I decided to ride that section because I wanted to ride across Monaco.

#### SNCF 🇫🇷 

TODO: fact check this

France has a very good high speed network, with very rapid trains (>250km/h) connecting the north to the south. However the bike spaces on these super fast trains are few or don't exist at all. I witnessed the Rinko bike set up was a big thing in France, probably as a result.

It is possible to take your bike on every regional train, which have good facilities for bikes. Sometimes you need to make a reservation, and sometimes not. This varies region to region.

It is free to take your bike on TER regional trains in the Occitanie region, but you should make a online bike reservation to avoid any problems if the train is packed :wink:. If you don't have one and the train is full you might be asked to leave the train.

Booking a reservation in this region can only be done online using (acces-velo-serein-liotrain.com)[acces-velo-serein-liotrain.com], its a easy process. TODO: check thisacces-velo-serein-liotrain.com

TODO: insert a gif of the booking process...

The French Cote da azure region similarly requires a reservation to take a bike on regional trains, but only some train lines. This is done using TODO:nsert website. However, the line I was on (marseille -> Nice) didn't require one.

## The tour 🚵

The tour was a good one, lots of big mountain fun with the gang!

TODO: add video

I loved it. Here is a map showing the route that we took and some interesting features we passed.

By the way, lots of the time we actually where hike-and-biking. This is a insane passion we share for pushing a bike up a hill for hours just to ride back down again (and sometime down when the rocks are too gnar to ride).

TODO: add the map of the route including pics at the right places! add river crossings from kreuzungen and calculate board crossing and other monuments passed.

🇫🇷
🇪🇸
🇦🇩

A interesting geographical thing along the route was the enclave/exclave of Livia. this little town + hill is Spanish (debatably Catalan). Basically when Spain and France made the deal to create the modern day boarded, it included a term about all the towns on the northern side becoming French. Livia was in a loop-hole situation and said that is was not a town, so the rules didn't apply and some how that held up. History is nuts!

## Route 🗺️

- Innsbruck -> Brenner (S bahn) €10.10 + €2.60 for the bike
- Brenner -> Verona (Trente Italia Regionale 204 bike 4*) €26.60 + €3.50 Train no. 3845
  - I actually had some time to wait, so took the opertunity to cruise down hill on my faveriot cycle path to the next station.
  - The most bike room ever, like 2 full carts (check how many).
  - Over Night in Verona @ castel Camping
  - wake up before the sunrise, pack the tent and ride through the romantic city of verona.
- Verona -> Milan (1:20)
  - Brought the ticket online
  - TODO: insert a pic.
- Milan -> Ventimiglia (4:00)
- Ventimiglia -> Nice (Bike riding. Went through the whole of Monaco!)
  I arrived around for lunch in Ventimiglia and then hit the road. It was stunning! I stuck to the coast and was quickly speeding through a tunnel to a signpost signify the french boarder. I love a good schegen crossing on my bike 
- Nice -> Marseille St. Charles (SNCF regional TER 20:25 -> 23:03 €39.80 free bike bike 5* power wifi)
  - Amazing useage of web maps on the "connect to wifi" landing page ![Screen shot of the SNCF map https://wifi.sncf/en/journey](image.png)
- Marseille -> Narbonne
- Narbone -> 

```json
[
  { 
    id: 1,
    start_station: Innsbruck Hauptbanhof 
    end_station: Brenner
    start_time: "13:41"
    end_time: ""
    delay_mins: 0
    cost_euros: 
    train_company: ÖBB
    train_type: S-bahn (city -> suburbs)
    wifi: No
    toilets: yes
    bike_space_rating: 4
    geojson: {}
  },
]
```

## Return route

tour de carol -> Toulouse Matabieun TER871470 7:29 €12
Toulouse -> Narbonne TER86975 €30.00
Narbonne -> Marseille TER876542 14:31 -> 17:48 €45.20
Marseille -> Nice TER17493 18:57 -> 21:38 €39.80
Nice -> Ventimiglia TER86097 22:19 -> 21:11 €9.20

I stopped in Menton, the last town in France for the night and stayed at a beautiful campsite up a hill, overlooking the french rivera.

I set no alarm and the next day I woke up to beautiful views. I rode down through the city, and cruised along the coast, through the boarder to italy. It is a incredibly beautiful part of the world, with the coast and the mountains behind it. 

Arriving in Ventimiglia, I checked out the train situation and learnt that the first train to Milan was full. I could pay a extra €50 to ride anyway, which explicitly includes having no seat, or I could wait 2 hours for the next regional. Having no time pressure I went for the later option, and enjoyed a ride along the coast to San Remo along with a swim to cool me off along route 🏊.

A big highlight was the old train tunnel which is now a bike only tunnel and has a exhibit which plays homage to Milan San Remo race. The was really cool. Also I was suprised by the train station, a super modernist i-dont-even-know architecture and the platform was 500m into the hill.

San Remo -> Savona RE12267 12:46 -> 14:25 €34.50 + €3.50 
Savona -> Milano Lambrate RE3035 14:35 -> 17:27 inlcuded with the above
Milano Lambrate -> Verona Porta Nuevo RE2635 17:33 -> 19:17 included with the above

** There was a issue with the train to milano arriving late and missing my connection to Verona. As a result I took the Trenord to Brescia and then to Verona.

Milan Lambrate -> Brescia R4 Trenord 17:59 -> 18:53
Brescia -> Verona R2637

I spent another night at my favorite campsite in Verona, and then took the train to Bolzano the next day.

Verona -> Bolzano  Trenteitalia 11:06 -> 13:23 €14.90 + €3.50

## Putting the map together

I wanted to make an interactive map to show the journey, the train routes and the bike rides. With the following features:

- train stations as Points
- train legs displayed as LineString, the color should represent which country the train is
- bike rides displayed as LineString, the color should represent the bike route
- Hover actions to show information about the journey leg
- extra points of interest along the way
  - Campsites
  - Pictures

### Train data

Along the journey, I noted down the different trains that I took, and included the arrival and destination times, the ticket price, if the train had wifi and rated how good the bike carrying set up was.

I structured this data as a json with the following schema:

```json
{
  "type": "array",
  "items": {
    "type": "object",
    "properties": {
      "id": {
        "type": "integer",
        "description": "A unique identifier for each leg of the journey."
      },
      "start_station": {
        "type": "string",
        "description": "The station where the journey leg starts."
      },
      "end_station": {
        "type": "string",
        "description": "The station where the journey leg ends."
      },
      "start_time": {
        "type": "string",
        "format": "time",
        "description": "The time the journey leg begins (in HH:MM format)."
      },
      "end_time": {
        "type": "string",
        "format": "time",
        "description": "The time the journey leg ends (in HH:MM format)."
      },
      "delay_mins": {
        "type": "integer",
        "description": "Delay in minutes, if any."
      },
      "cost_euros": {
        "type": ["number", "string"],
        "description": "The cost of the journey leg in euros. Can be a number or an empty string if unknown."
      },
      "train_company": {
        "type": "string",
        "description": "The company operating the train."
      },
      "train_number": {
        "type": ["string", "null"],
        "description": "The specific train number for the journey leg. Nullable if not applicable."
      },
      "train_type": {
        "type": "string",
        "description": "The type of train or mode of transportation."
      },
      "wifi": {
        "type": "string",
        "description": "Indicates whether Wi-Fi is available on the train (Yes/No)."
      },
      "toilets": {
        "type": "string",
        "description": "Indicates whether toilets are available on the train (Yes/No)."
      },
      "bike_space_rating": {
        "type": ["integer", "string"],
        "description": "Rating of the bike space on the train. Can be a number or 'N/A' if not applicable."
      },
      "geojson": {
        "type": "object",
        "description": "Placeholder for GeoJSON data for the route (geometry and properties)."
      }
    },
    "required": [
      "id",
      "start_station",
      "end_station",
      "start_time",
      "end_time",
      "delay_mins",
      "cost_euros",
      "train_company",
      "train_type",
      "wifi",
      "toilets",
      "bike_space_rating",
      "geojson"
    ],
    "additionalProperties": false
  }
}
```

The resulting return route looked like this:

```json
[
  {
    "id": 7,
    "start_station": "Tour de Carol",
    "end_station": "Toulouse Matabieu",
    "start_time": "07:29",
    "end_time": "",
    "delay_mins": 0,
    "cost_euros": 12,
    "train_company": "SNCF",
    "train_number": "TER871470",
    "train_type": "Regional",
    "wifi": "No",
    "toilets": "Yes",
    "bike_space_rating": "N/A",
  },
  {
    "id": 8,
    "start_station": "Toulouse",
    "end_station": "Narbonne",
    "start_time": "",
    "end_time": "",
    "delay_mins": 0,
    "cost_euros": 30,
    "train_company": "SNCF",
    "train_number": "TER86975",
    "train_type": "Regional",
    "wifi": "No",
    "toilets": "Yes",
    "bike_space_rating": "N/A",
  },
  {
    "id": 9,
    "start_station": "Narbonne",
    "end_station": "Marseille",
    "start_time": "14:31",
    "end_time": "17:48",
    "delay_mins": 0,
    "cost_euros": 45.20,
    "train_company": "SNCF",
    "train_number": "TER876542",
    "train_type": "Regional",
    "wifi": "No",
    "toilets": "Yes",
    "bike_space_rating": "N/A",
  },
  {
    "id": 10,
    "start_station": "Marseille",
    "end_station": "Nice",
    "start_time": "18:57",
    "end_time": "21:38",
    "delay_mins": 0,
    "cost_euros": 39.80,
    "train_company": "SNCF",
    "train_number": "TER17493",
    "train_type": "Regional",
    "wifi": "No",
    "toilets": "Yes",
    "bike_space_rating": "N/A",
  },
  {
    "id": 11,
    "start_station": "Nice",
    "end_station": "Ventimiglia",
    "start_time": "22:19",
    "end_time": "21:11",
    "delay_mins": 0,
    "cost_euros": 9.20,
    "train_company": "SNCF",
    "train_number": "TER86097",
    "train_type": "Regional",
    "wifi": "No",
    "toilets": "Yes",
    "bike_space_rating": "N/A",
  },
  {
    "id": 12,
    "start_station": "San Remo",
    "end_station": "Savona",
    "start_time": "12:46",
    "end_time": "14:25",
    "delay_mins": 0,
    "cost_euros": 34.50,
    "train_company": "Trenitalia",
    "train_number": "RE12267",
    "train_type": "Regional",
    "wifi": "No",
    "toilets": "Yes",
    "bike_space_rating": 3,
  },
  {
    "id": 13,
    "start_station": "Savona",
    "end_station": "Milano Lambrate",
    "start_time": "14:35",
    "end_time": "17:27",
    "delay_mins": 0,
    "cost_euros": "",
    "train_company": "Trenitalia",
    "train_number": "RE3035",
    "train_type": "Regional",
    "wifi": "No",
    "toilets": "Yes",
    "bike_space_rating": 3,
  },
  {
    "id": 14,
    "start_station": "Milano Lambrate",
    "end_station": "Verona Porta Nuova",
    "start_time": "17:33",
    "end_time": "19:17",
    "delay_mins": 0,
    "cost_euros": "",
    "train_company": "Trenitalia",
    "train_number": "RE2635",
    "train_type": "Regional",
    "wifi": "No",
    "toilets": "Yes",
    "bike_space_rating": 3,
  },
  {
    "id": 15,
    "start_station": "Milano Lambrate",
    "end_station": "Brescia",
    "start_time": "17:59",
    "end_time": "18:53",
    "delay_mins": 0,
    "cost_euros": "",
    "train_company": "Trenord",
    "train_number": "R4",
    "train_type": "Regional",
    "wifi": "No",
    "toilets": "Yes",
    "bike_space_rating": 3,
  },
  {
    "id": 16,
    "start_station": "Brescia",
    "end_station": "Verona",
    "start_time": "",
    "end_time": "",
    "delay_mins": 0,
    "cost_euros": "",
    "train_company": "Trenitalia",
    "train_number": "R2637",
    "train_type": "Regional",
    "wifi": "No",
    "toilets": "Yes",
    "bike_space_rating": 3,
  }
]
```

The next step was adding the geospatial data of the train route.

To get the geometric data of the train journeys I would have to consult the internet.

Like most geospatial problems, this can solved in numerous differnt ways, and a good knowledge of the tools available is key to finding the best solution for the problem at hand. I wish I could import knowledge of all tools out there into my brain, but I can't. So I have to rely on my experience and searching the internet to help me out.

The gtfs data format is a great resource for train data. It stands for General Transit Feed Specification and is a format for public transportation schedules and associated geographic information. It is used by many public transportation agencies to share their data with developers and other interested parties. This is what is used by google maps to show you the train times and routes.

Unfortunately for me, although the data is available in the same format, and is open data, it is not always easy to find and there was no single source for the data I needed. This is a place that many people are trying to improve, but it is clearly still a work in progress.

Instead I found `https://trainmap.ntag.fr` and someone had a differnt approach, instead or relying on the train companies, it uses osm data and osmrouting to generate the routes from the rail network. This approach has its limitations, but it was perfect for quickly solving my use case.

I wrote a simple python script that looked up the the id of each train station from a [csv by trainline.eu](https://raw.githubusercontent.com/trainline-eu/stations/master/stations.csv) and would try to request the geojson from the api at `https://trainmap.ntag.fr/api/route/?simplify=1&dep={dep_id}&arr={arr_id}` where `dep` and `arr` are the station ids.

```python

```

<script src="https://asciinema.org/a/Bsxr2058rU7SGwAhR7Yih3ZLN.js" id="asciicast-Bsxr2058rU7SGwAhR7Yih3ZLN" async="true"></script>

The returned geojson feature was slightly off, as it always returned a "type: Polygon" instead of "type: LineString" but the data was a legit LineString. So I data wrangled the type and added the structured data to the properties of the geojson feature.

I did a quick santity check using [geojson.io](geojson.io) and all looked good.

TODO: add screen shot, or even link to geojson.io

![alt text](image.png)

{{<image src="/media/trains/geojson_io.png" alt="Screenshot of geojson.io" >}}

### Bike ride data

To complete this data representation of my journey, I would need to add the sections that I rode my bike. For the sections that I rode my bike, I used Komoot to record the data and downloaded the data as a gpx file. I wanted to convert the `.gpx` file into a `geojson` LineString feature and add it to the feature collection.

There is a great tool out there called [`gdal`](https://gdal.org) which is described itself as:

> GDAL is a translator library for raster and vector geospatial data formats

Sounds perfect, a sword of the geospatial data wrangler! I inspected the gpx files using `ogrinfo` and wrote a little one liner using the [`ogr2ogr`](https://gdal.org/en/latest/faq.html#what-is-this-ogr-stuff)  and let the tool do its magic.

GPX files are, in short, XML files with different tags for different types of geospatial data.

`<wpt>` tags are used to represent waypoints
`<trk>` tags are used to represent tracks
`<rte>` tags are used to represent routes

I used `ogrinfo` to inspect the data to confirm it only contained a track and no other elements.

```bash
➜  trains ogrinfo -al -so data/menton_sanremo.gpx 
INFO: Open of `data/menton_sanremo.gpx'
      using driver `GPX' successful.
Metadata:
  AUTHOR_LINK_HREF=https://www.komoot.de
  AUTHOR_LINK_TEXT=komoot
  AUTHOR_LINK_TYPE=text/html
  NAME=Road Ride

Layer name: waypoints
Geometry: Point
Feature Count: 0
Layer SRS WKT:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["geodetic latitude (Lat)",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["geodetic longitude (Lon)",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]
Data axis to CRS axis mapping: 2,1
ele: Real (0.0)
time: DateTime
magvar: Real (0.0)
geoidheight: Real (0.0)
name: String (0.0)
cmt: String (0.0)
desc: String (0.0)
src: String (0.0)
link1_href: String (0.0)
link1_text: String (0.0)
link1_type: String (0.0)
link2_href: String (0.0)
link2_text: String (0.0)
link2_type: String (0.0)
sym: String (0.0)
type: String (0.0)
fix: String (0.0)
sat: Integer (0.0)
hdop: Real (0.0)
vdop: Real (0.0)
pdop: Real (0.0)
ageofdgpsdata: Real (0.0)
dgpsid: Integer (0.0)

Layer name: routes
Geometry: Line String
Feature Count: 0
Layer SRS WKT:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["geodetic latitude (Lat)",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["geodetic longitude (Lon)",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]
Data axis to CRS axis mapping: 2,1
name: String (0.0)
cmt: String (0.0)
desc: String (0.0)
src: String (0.0)
link1_href: String (0.0)
link1_text: String (0.0)
link1_type: String (0.0)
link2_href: String (0.0)
link2_text: String (0.0)
link2_type: String (0.0)
number: Integer (0.0)
type: String (0.0)

Layer name: tracks
Geometry: Multi Line String
Feature Count: 1
Extent: (7.507404, 43.774250) - (7.784715, 43.822411)
Layer SRS WKT:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["geodetic latitude (Lat)",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["geodetic longitude (Lon)",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]
Data axis to CRS axis mapping: 2,1
name: String (0.0)
cmt: String (0.0)
desc: String (0.0)
src: String (0.0)
link1_href: String (0.0)
link1_text: String (0.0)
link1_type: String (0.0)
link2_href: String (0.0)
link2_text: String (0.0)
link2_type: String (0.0)
number: Integer (0.0)
type: String (0.0)

Layer name: route_points
Geometry: Point
Feature Count: 0
Layer SRS WKT:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["geodetic latitude (Lat)",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["geodetic longitude (Lon)",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]
Data axis to CRS axis mapping: 2,1
route_fid: Integer (0.0)
route_point_id: Integer (0.0)
ele: Real (0.0)
time: DateTime
magvar: Real (0.0)
geoidheight: Real (0.0)
name: String (0.0)
cmt: String (0.0)
desc: String (0.0)
src: String (0.0)
link1_href: String (0.0)
link1_text: String (0.0)
link1_type: String (0.0)
link2_href: String (0.0)
link2_text: String (0.0)
link2_type: String (0.0)
sym: String (0.0)
type: String (0.0)
fix: String (0.0)
sat: Integer (0.0)
hdop: Real (0.0)
vdop: Real (0.0)
pdop: Real (0.0)
ageofdgpsdata: Real (0.0)
dgpsid: Integer (0.0)

Layer name: track_points
Geometry: Point
Feature Count: 2280
Extent: (7.507404, 43.774250) - (7.784715, 43.822411)
Layer SRS WKT:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["geodetic latitude (Lat)",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["geodetic longitude (Lon)",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]
Data axis to CRS axis mapping: 2,1
track_fid: Integer (0.0)
track_seg_id: Integer (0.0)
track_seg_point_id: Integer (0.0)
ele: Real (0.0)
time: DateTime
magvar: Real (0.0)
geoidheight: Real (0.0)
name: String (0.0)
cmt: String (0.0)
desc: String (0.0)
src: String (0.0)
link1_href: String (0.0)
link1_text: String (0.0)
link1_type: String (0.0)
link2_href: String (0.0)
link2_text: String (0.0)
link2_type: String (0.0)
sym: String (0.0)
type: String (0.0)
fix: String (0.0)
sat: Integer (0.0)
hdop: Real (0.0)
vdop: Real (0.0)
pdop: Real (0.0)
ageofdgpsdata: Real (0.0)
dgpsid: Integer (0.0)
```

Seems legit, the `tracks` layer contains the data I want. I can now convert this to a `geojson` file using the `ogr2ogr` command line tool.

```bash
for file in data/*.gpx; do ogr2ogr -f "GeoJSON" -nlt LINESTRING -sql "SELECT *, 'yes' AS bike FROM tracks" "${file%.gpx}.geojson" "$file"; done
```

This command loops through all the `.gpx` files in the `data` directory and converts them to `geojson` files with the same name.

The sql query `-sql "SELECT *, 'yes' AS bike FROM tracks"` selects all the data from the `tracks` layer which referes to the `<trk>` elements in the `.gpx` file. It will take any of the attributes from the `<trk>` element and add them to the `properties` of the `geojson` feature, in our case thats the name. I
also add a new field called `bike` with the value `yes` to indicate that this is a bike ride.

The `-nlt LINESTRING` flag tells `ogr2ogr` to convert the data to a `LineString` feature, if I didn't include this flag the data would be converted to a `MultiLineString` feature which is not what I want.

There is many ways to achieve the above data processing, and a vast amount of open tools out there to help achieve pretty much anything you want. Long live Open Data and open source software!

Finally I used [maplibre-gl](https://maplibre.org/) to visualize the data. My idea was to make a little static webpage with I wanted the features:

- journey legs displayed on a color coded line depending on the train company or if it was cycled
- Hover actionss
- Pop up displaying information about the leg
  - Train number
  - Train type
  - Train operator
  - bike rating
  - wifi
  - price

I used webpack to bundle the little website up and then deployed it using the classic github pages.

To embed the map into this blog post, I added a iframe and set the src to point to the github pages url.

```html
<iframe src="https://jamesmcclain.github.io/train-bike-journey/" width="100%" height="600"></iframe>
```

{{<admonition type="tip" title="Tip" open="true">}}

{{</admonition>}}
```

## Totals and stats

After adding together how much it cost it took me 

€ TODO: add this shit up.
Hours moving in trains
km on the bike
4 espressos
TODO: add some stats, total rivers crossed, tunnels went through, pizza eaten, 
Crashes 

